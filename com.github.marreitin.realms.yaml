app-id: com.github.marreitin.realms
runtime: org.gnome.Platform
runtime-version: "47"
sdk: org.gnome.Sdk
command: realms
tags:
    - devel
    - development
    - nightly
finish-args:
    - --share=ipc
    - --socket=fallback-x11
    - --socket=x11
    - --socket=wayland
    - --socket=pulseaudio
    - --share=network
    - --device=all
    - --system-talk-name=org.freedesktop.timedate1
    - --filesystem=home
modules:
  - name: libvirt-glib
    buildsystem: meson
    sources:
      - type: git
        url: https://gitlab.com/libvirt/libvirt-glib
        branch: master
    modules:
      - name: libnl
        sources:
          - type: archive
            url: https://github.com/thom311/libnl/releases/download/libnl3_5_0/libnl-3.5.0.tar.gz
            sha256: 352133ec9545da76f77e70ccb48c9d7e5324d67f6474744647a7ed382b5e05fa
      - name: yajl
        buildsystem: cmake-ninja
        builddir: true
        config-opts:
          - -DCMAKE_BUILD_TYPE=Release
        sources:
          - type: archive
            url: https://github.com/lloyd/yajl/archive/refs/tags/2.1.0.tar.gz
            sha256: 3fb73364a5a30efe615046d07e6db9d09fd2b41c763c5f7d3bfb121cd5c5ac5a
      - name: libtirpc
        config-opts:
          - --disable-gssapi
          - --libdir=/app/lib
        sources:
          - type: archive
            url: https://downloads.sourceforge.net/sourceforge/libtirpc/libtirpc-1.3.2.tar.bz2
            sha256: e24eb88b8ce7db3b7ca6eb80115dd1284abc5ec32a8deccfed2224fc2532b9fd
      - name: rpcsvc-proto
        buildsystem: autotools
        sources:
          - type: archive
            url: https://github.com/thkukuk/rpcsvc-proto/archive/v1.4.1.tar.gz
            sha256: 750f7e57b81407a25b707867e90d7ee80aeb53bf515b114fc218f3c78dc9a6e8
      - name: libvirt
        builddir: true
        buildsystem: meson
        build-options:
            cflags: -I/app/include/tirpc -ltirpc
        config-opts:
            - -Ddocs=disabled
        sources:
          - type: archive
            url: https://libvirt.org/sources/libvirt-9.0.0.tar.xz
            sha256: deca5cff1b7baac297bca9663907c61f71a47183371dc7ac019c107806d5435a
  - name: govf
    config-opts:
        - --libdir=/app/lib
    buildsystem: meson
    sources:
      - type: git
        url: https://gitlab.gnome.org/felipeborges/libovf-glib.git
  - name: libportal
    buildsystem: meson
    config-opts:
      - -Dbackend-gtk3=disabled
      - -Dbackend-gtk4=enabled
      - -Ddocs=false
      - -Dtests=false
    sources:
      - type: git
        url: https://github.com/flatpak/libportal.git
        branch: main
  - name: realms
    buildsystem: meson
    sources:
      - type: dir
        path: .
